// Edge case tests (should compile and run)
// Covers: empty arrays, nested scopes, mixed numeric promotions, compound assignments, increment/decrement,
// while loops with zero iterations, if without else, function returning array, function with array params

import @firescript/std.io.{println};

println("-- edge: fixed-size array basics --");
int32[] simple = [1, 2];
println(simple[0]);
println(simple.length());

println("-- edge: nested scopes deep variable access --");
int32 base = 5;
{
    int32 a = base + 1;
    {
    int32 b = a + 1;
        {
            int32 c = b + 1; // chain
            println(c); // expect 8
        }
    }
}

println("-- edge: numeric same-type arithmetic --");
int32 i = 2;
float32 f = 3.0f;
float64 dd = 4.0;
// Only same-type arithmetic is allowed; demonstrate valid cases
println(i + 5); // int32
println(f + 2.0f); // float32
println(dd + 1.0); // float64

println("-- edge: compound assignments and inc/dec --");
int32 cx = 10;
// simple compound (ensuring parser accepts it)
cx += 5;
cx -= 3;
cx *= 2;
cx /= 3;
cx %= 4;
println(cx); // final value just for exercise

int32 counter = 0;
counter++;
counter++;
counter--;
println(counter);

println("-- edge: while loop zero iterations --");
int32 limit = 0;
while (limit < 0) { // should not execute (int32 < int32 is valid)
    println("UNREACHABLE");
}
println("loop skipped");

println("-- edge: functions (no array params/returns) --");
int32 add2(int32 x, int32 y) {
    return x + y;
}
println(add2(10, 11)); // 21

println("-- edge: method argument type mismatch is not here (all valid) --");
int32[] seq = [99,2,3];
println(seq[0]); // 99

println("-- edge: array access expression in arithmetic --");
int32 x = seq[0] + 1; // tests ARRAY_ACCESS inside expression
println(x);

println("-- edge: equality and relational chaining separately --");
println( (1 + 2) == 3 );
println( (1 + 2) > 2 );
println( (1 + 2) < 5 );

println("-- edge: reuse variable with new array --");
int32[] seq2 = [42];
println(seq2[0]);

println("-- edge: avoid empty array literals in fixed-size mode --");

println("-- edge cases complete --");
